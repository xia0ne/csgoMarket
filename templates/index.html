<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <link rel="shortcut icon" href="https://buff.163.com/favicon.ico" type="image/x-icon" />
    <title>ğŸ’Buffä»·æ ¼ç›‘æ§</title>
    <link rel="stylesheet" href="../templates/layui/css/layui.css" media="all" />
</head>

<body class="layui-layout-body">
    <div class="layui-header">
        <center>
            <h1>Buffä»·æ ¼ç›‘æ§</h1>
        </center>
    </div>
    <div class="layui-body">
        <div clss="layui-container">
            <div class="layui-row">
                <div class="layui-col-md9">
                    <div class="layui-tab layui-tab-card" style="right:10%;">
                        <ul class="layui-tab-title">
                            <li class="layui-this">ä»·æ ¼ç›‘æ§</li>
                            <li>æ·»åŠ å•†å“id</li>
                        </ul>
                        <div class="layui-tab-content" style="height: 450px; width: 700px">
                            <div class="layui-tab-item layui-show">
                                <h5> ğŸ’©å¦‚éœ€æ›´æ–°åˆ·æ–°é¡µé¢å³å¯ ğŸ’© </h5>
                                <table id="demo" lay-filter="test"></table>
                            </div>
                            <div class="layui-tab-item">
                                <form class = "layui-form layui-form-pane" action="">
                                    <div class="layui-form-item" pane>
                                        <label class="layui-form-label">å•†å“ID</label>
                                        <div class="layui-input-block">
                                            <input type="text" name="title" required lay-verify="required"
                                                placeholder="è¯·è¾“å…¥å•†å“ID" autocomplete="off" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-form-item" pane>
                                        <div class="layui-input-block">
                                          <button class="layui-btn" type="button" onclick="javascript:addBuffer()">ç«‹å³æäº¤</button>
                                          <button type="reset" class="layui-btn layui-btn-primary">é‡ç½®</button>
                                        </div>
                                </div>
                                </form>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <script src="../templates/layui/layui.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script type="text/javascript" >
            function addBuffer(){
                var data = document.getElementsByName("title")[0].value;
                console.log(data);
                if(data == ""){
                    layer.msg("è¯·è¾“å…¥å•†å“ID");
                    return false;
                }
                var api = "http://127.0.0.1:8000/submit/"+data;
                var form = new FormData();
                var settings = {
                    "url": api,
                    "method": "POST",
                    "timeout": 0,
                    "processData": false,
                    "mimeType": "multipart/form-data",
                    "contentType": false,
                    "data": form
                };
                // æ‰§è¡Œpost
                $.post(settings).done(function (response) {
                    console.log(response);
                    //jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºjsonå¯¹è±¡
                    response = JSON.parse(response);
                    if(response["code"] == 200){
                        layer.msg("æ·»åŠ æˆåŠŸï¼Œè¯·åˆ·æ–°é¡µé¢");
                    }else if(response["code"] == 400){
                        layer.msg("é‡å¤æ·»åŠ ï¼Œè¯·å‹¿é‡å¤æ·»åŠ ");
                    }else{  
                        layer.msg("æ·»åŠ å¤±è´¥ï¼Œè¯·æ£€æŸ¥å•†å“IDæ˜¯å¦æ­£ç¡®");
                    }
                });
            }
        </script>
        <script>
            layui.use("element", function () {
                var element = layui.element;
            });
        </script>
        <script>
            layui.use("table", function () {
                var table = layui.table;

                //ç¬¬ä¸€ä¸ªå®ä¾‹
                table.render({
                    elem: "#demo",
                    height: 400,
                    width: 1135,
                    url: "http://127.0.0.1:8000/get", //æ•°æ®æ¥å£
                    page: true, //å¼€å¯åˆ†é¡µ
                    cols: [
                        [
                            //è¡¨å¤´
                            {
                                field: "å•†å“åç§°",
                                title: "å•†å“åç§°",
                                width: 500,
                            },
                            { field: "steamCNYä»·æ ¼", title: "steamCNYä»·æ ¼", width: 200 },
                            { field: "ç©å®¶ä»·æ ¼å‰äº”", title: "ç©å®¶ä»·æ ¼å‰äº”", width: 430 },
                        ],
                    ],
                });
            });
        </script>
</body>
<footer>
    <div class="layui-footer">
        <font color="gray"><a href="https://github.com/xia0ne/csgoMarket">Â© 2022ç½‘æ˜“BUFF-CSGOåº“å­˜ç›‘æ§</a></font>
    </div>
</footer>

</html>